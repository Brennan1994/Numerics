<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Numerics: C:/GIT 2/numerics/.NET 8.0/Numerics/Distributions/Univariate/Uncertainty Analysis/BootstrapAnalysis.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Numerics<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">Numerics is an opensource library for .NET developed by the U.S. Army Corps of Engineers Risk Management Center (USACE-RMC). Numerics provides a comprehensive set of methods and algorithms for numerical computations and statistical analysis, serving as a cornerstone of the RMC software suite. The library includes routines for specialized functions, interpolation, regression, statistics, machine learning, probability distributions, bootstrap uncertainty analysis, Bayesian Markov Chain Monte Carlo, optimization, root finding, and more.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_bootstrap_analysis_8cs_source.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">BootstrapAnalysis.cs</div></div>
</div><!--header-->
<div class="contents">
<a href="_bootstrap_analysis_8cs.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">* NOTICE:</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">* The U.S. Army Corps of Engineers, Risk Management Center (USACE-RMC) makes no guarantees about</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">* the results, or appropriateness of outputs, obtained from Numerics.</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">*</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">* LIST OF CONDITIONS:</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">* provided that the following conditions are met:</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">* ● Redistributions of source code must retain the above notice, this list of conditions, and the</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">* following disclaimer.</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">* ● Redistributions in binary form must reproduce the above notice, this list of conditions, and</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">* the following disclaimer in the documentation and/or other materials provided with the distribution.</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">* ● The names of the U.S. Government, the U.S. Army Corps of Engineers, the Institute for Water</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment">* Resources, or the Risk Management Center may not be used to endorse or promote products derived</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment">* from this software without specific prior written permission. Nor may the names of its contributors</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment">* be used to endorse or promote products derived from this software without specific prior</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment">* written permission.</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment">*</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment">* DISCLAIMER:</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment">* THIS SOFTWARE IS PROVIDED BY THE U.S. ARMY CORPS OF ENGINEERS RISK MANAGEMENT CENTER</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="comment">* (USACE-RMC) &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="comment">* THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="comment">* DISCLAIMED. IN NO EVENT SHALL USACE-RMC BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="comment">* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="comment">* PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="comment">* INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="comment">* LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="comment">* THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="comment">*/</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span> </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="keyword">using </span>System;</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="keyword">using </span>System.Collections.Generic;</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="keyword">using </span>System.Linq;</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="keyword">using </span>System.Threading.Tasks;</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="keyword">using </span><a class="code hl_namespace" href="namespace_numerics_1_1_data.html">Numerics.Data</a>;</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="keyword">using </span><a class="code hl_namespace" href="namespace_numerics_1_1_data_1_1_statistics.html">Numerics.Data.Statistics</a>;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="keyword">using </span><a class="code hl_namespace" href="namespace_numerics_1_1_mathematics_1_1_optimization.html">Numerics.Mathematics.Optimization</a>;</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="keyword">using </span><a class="code hl_namespace" href="namespace_numerics_1_1_sampling.html">Numerics.Sampling</a>;</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span> </div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_numerics_1_1_distributions.html">Numerics.Distributions</a></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>{</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span> </div>
<div class="foldopen" id="foldopen00055" data-start="{" data-end="};">
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html">   55</a></span>    <span class="keyword">public</span> <span class="keyword">class </span><a class="code hl_class" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html">BootstrapAnalysis</a></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>    {</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span> </div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="preprocessor">        #region Construction</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span> </div>
<div class="foldopen" id="foldopen00068" data-start="{" data-end="}">
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ab424119e10d760fc36750cd9e51b5568">   68</a></span>        <span class="keyword">public</span> <a class="code hl_function" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ab424119e10d760fc36750cd9e51b5568">BootstrapAnalysis</a>(<a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_univariate_distribution.html">IUnivariateDistribution</a> distribution, <a class="code hl_enumeration" href="namespace_numerics_1_1_distributions.html#adc80e995453c173b9f9c8a6963b37a3b">ParameterEstimationMethod</a> estimationMethod, <span class="keywordtype">int</span> sampleSize, <span class="keywordtype">int</span> replications = 10000, <span class="keywordtype">int</span> seed = 12345)</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>        {</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>            <span class="keywordflow">if</span> (distribution as <a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_bootstrappable.html">IBootstrappable</a> == <span class="keyword">null</span>) <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentException(<span class="stringliteral">&quot;The distribution must implement IBootstrappable.&quot;</span>, nameof(<a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a88e5d424b1364cc22bb1dabe9175f5f2">Distribution</a>));</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>            <span class="keywordflow">if</span> (sampleSize &lt; 10) <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentOutOfRangeException(nameof(<a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a01d522a40dc093f4bdb875850ff2574c">SampleSize</a>), <span class="stringliteral">&quot;The sample size must at least 10.&quot;</span>);</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>            <span class="keywordflow">if</span> (replications &lt; 100) <span class="keywordflow">throw</span> <span class="keyword">new</span> ArgumentOutOfRangeException(nameof(<a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ab8c46f0743c1f95832afbda159123405">Replications</a>), <span class="stringliteral">&quot;The number of bootstrap replications must be at least 100.&quot;</span>);</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span> </div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>            <a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a88e5d424b1364cc22bb1dabe9175f5f2">Distribution</a> = (<a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_bootstrappable.html">IBootstrappable</a>)distribution;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>            <a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#abdcdf72f5f676d7e424f4ef66bf91a7a">EstimationMethod</a> = estimationMethod;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>            <a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a01d522a40dc093f4bdb875850ff2574c">SampleSize</a> = sampleSize;</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>            <a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ab8c46f0743c1f95832afbda159123405">Replications</a> = replications;</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>            <a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a65f1f143031de56c992df1fec867b66d">PRNGSeed</a> = seed;</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>        }</div>
</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span><span class="preprocessor">        #endregion</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span> </div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span><span class="preprocessor">        #region Members</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span> </div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>        <span class="keyword">private</span> <span class="keywordtype">int</span> _retries = 20;</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span> </div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#abdcdf72f5f676d7e424f4ef66bf91a7a">   90</a></span>        <span class="keyword">public</span> <a class="code hl_enumeration" href="namespace_numerics_1_1_distributions.html#adc80e995453c173b9f9c8a6963b37a3b">ParameterEstimationMethod</a> <a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#abdcdf72f5f676d7e424f4ef66bf91a7a">EstimationMethod</a> { <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; }</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span> </div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a88e5d424b1364cc22bb1dabe9175f5f2">   95</a></span>        <span class="keyword">public</span> <a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_bootstrappable.html">IBootstrappable</a> <a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a88e5d424b1364cc22bb1dabe9175f5f2">Distribution</a> { <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; }</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a01d522a40dc093f4bdb875850ff2574c">  100</a></span>        <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a01d522a40dc093f4bdb875850ff2574c">SampleSize</a> { <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; }</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ab8c46f0743c1f95832afbda159123405">  105</a></span>        <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ab8c46f0743c1f95832afbda159123405">Replications</a> { <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; }</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a65f1f143031de56c992df1fec867b66d">  110</a></span>        <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a65f1f143031de56c992df1fec867b66d">PRNGSeed</a> { <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; }</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span> </div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span><span class="preprocessor">        #endregion</span></div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span> </div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span><span class="preprocessor">        #region Methods</span></div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span> </div>
<div class="foldopen" id="foldopen00119" data-start="{" data-end="}">
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a4adb3913e71f970a8df129eee43813f6">  119</a></span>        <span class="keyword">public</span> <a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_univariate_distribution.html">IUnivariateDistribution</a>[] <a class="code hl_function" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a4adb3913e71f970a8df129eee43813f6">Distributions</a>()</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>        {</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>            var bootDistributions = <span class="keyword">new</span> <a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_univariate_distribution.html">IUnivariateDistribution</a>[<a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ab8c46f0743c1f95832afbda159123405">Replications</a>];</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>            var r = <span class="keyword">new</span> <a class="code hl_class" href="class_numerics_1_1_sampling_1_1_mersenne_twister.html">MersenneTwister</a>(<a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a65f1f143031de56c992df1fec867b66d">PRNGSeed</a>);</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>            var seeds = r.NextIntegers(<a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ab8c46f0743c1f95832afbda159123405">Replications</a>);</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>            Parallel.For(0, <a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ab8c46f0743c1f95832afbda159123405">Replications</a>, idx =&gt;</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>            {</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>                <span class="keywordtype">bool</span> failed = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; _retries; m++)</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>                {</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>                    <span class="keywordflow">try</span></div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>                    {</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>                        bootDistributions[idx] = <a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a88e5d424b1364cc22bb1dabe9175f5f2">Distribution</a>.<a class="code hl_function" href="interface_numerics_1_1_distributions_1_1_i_bootstrappable.html#a88c44db3a4defae4bb671e2fd71f30b1">Bootstrap</a>(<a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#abdcdf72f5f676d7e424f4ef66bf91a7a">EstimationMethod</a>, <a class="code hl_property" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a01d522a40dc093f4bdb875850ff2574c">SampleSize</a>, seeds[idx] + 10 * m);</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>                        failed = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>                    }</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>                    <span class="keywordflow">catch</span> (Exception)</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>                    {</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>                        failed = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>                    };</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span> </div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>                    <span class="keywordflow">if</span> (failed == <span class="keyword">false</span>) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>                }</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span> </div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>                <span class="comment">// MLE and certain L-moments methods can fail to find a solution</span></div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>                <span class="comment">// On fail, set to null</span></div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>                <span class="keywordflow">if</span> (failed == <span class="keyword">true</span>) bootDistributions[idx] = <span class="keyword">null</span>;</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span> </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>            });</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>            <span class="keywordflow">return</span> bootDistributions;</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>        }</div>
</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span> </div>
<div class="foldopen" id="foldopen00154" data-start="{" data-end="}">
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a03b48113c802dd76e2169526c3766b87">  154</a></span>        <span class="keyword">public</span> <a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_univariate_distribution.html">IUnivariateDistribution</a>[] <a class="code hl_function" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a03b48113c802dd76e2169526c3766b87">Distributions</a>(<a class="code hl_struct" href="struct_numerics_1_1_mathematics_1_1_optimization_1_1_parameter_set.html">ParameterSet</a>[] parameterSets)</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>        {</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>            var bootDistributions = <span class="keyword">new</span> <a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_univariate_distribution.html">IUnivariateDistribution</a>[parameterSets.Length];</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>            Parallel.For(0, parameterSets.Length, idx =&gt;</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>            {</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>                bool failed = false;</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>                try</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>                {</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>                    var dist = ((UnivariateDistributionBase)Distribution).Clone();</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>                    dist.SetParameters(parameterSets[idx].Values);</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>                    bootDistributions[idx] = dist;</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>                    failed = false;</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>                }</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>                catch (Exception)</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>                {</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>                    failed = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>                };</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span> </div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>                <span class="comment">// On fail, set to null</span></div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>                <span class="keywordflow">if</span> (failed == <span class="keyword">true</span>) bootDistributions[idx] = <span class="keyword">null</span>;</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span> </div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>            });</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>            <span class="keywordflow">return</span> bootDistributions;</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>        }</div>
</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span> </div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span> </div>
<div class="foldopen" id="foldopen00184" data-start="{" data-end="}">
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a6285e8342588812beaa78ee8c27aefe6">  184</a></span>        <span class="keyword">public</span> <span class="keywordtype">double</span>[,] <a class="code hl_function" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a6285e8342588812beaa78ee8c27aefe6">Parameters</a>(<a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_univariate_distribution.html">IUnivariateDistribution</a>[] distributions = <span class="keyword">null</span>)</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>        {</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>            var bootDistributions = distributions != <span class="keyword">null</span> ? distributions : Distributions();</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>            var bootParameters = <span class="keyword">new</span> <span class="keywordtype">double</span>[bootDistributions.Count(), Distribution.NumberOfParameters];</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>            Parallel.For(0, bootDistributions.Count(), idx =&gt;</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>            {</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>                if (bootDistributions[idx] != null)</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>                {</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>                    var parameters = bootDistributions[idx].GetParameters;</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>                    for (int i = 0; i &lt; Distribution.NumberOfParameters; i++)</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>                        bootParameters[idx, i] = parameters[i];</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>                }</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>                {</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>                    for (int i = 0; i &lt; Distribution.NumberOfParameters; i++)</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>                        bootParameters[idx, i] = double.NaN;</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>                }</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span> </div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>            });</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>            <span class="keywordflow">return</span> bootParameters;</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>        }</div>
</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span> </div>
<div class="foldopen" id="foldopen00209" data-start="{" data-end="}">
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a31a94a5c9deee8820e0c271717fb6768">  209</a></span>        <span class="keyword">public</span> <a class="code hl_struct" href="struct_numerics_1_1_mathematics_1_1_optimization_1_1_parameter_set.html">ParameterSet</a>[] <a class="code hl_function" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a31a94a5c9deee8820e0c271717fb6768">ParameterSets</a>(<a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_univariate_distribution.html">IUnivariateDistribution</a>[] distributions = <span class="keyword">null</span>)</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>        {</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>            var bootDistributions = distributions != <span class="keyword">null</span> ? distributions : Distributions();</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>            var bootParameters = <span class="keyword">new</span> <a class="code hl_struct" href="struct_numerics_1_1_mathematics_1_1_optimization_1_1_parameter_set.html">ParameterSet</a>[bootDistributions.Count()];</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>            Parallel.For(0, bootDistributions.Count(), idx =&gt;</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>            {</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>                if (bootDistributions[idx] != null)</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>                {</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>                    bootParameters[idx] = new ParameterSet(bootDistributions[idx].GetParameters, double.NaN);</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>                }</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>                {</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>                    var parameters = new double[Distribution.NumberOfParameters];</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>                    for (int i = 0; i &lt; Distribution.NumberOfParameters; i++)</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>                        parameters[i] = double.NaN;</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>                    bootParameters[idx] = new ParameterSet(parameters, double.NaN);</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>                }</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span> </div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>            });</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>            <span class="keywordflow">return</span> bootParameters;</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>        }</div>
</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span> </div>
<div class="foldopen" id="foldopen00234" data-start="{" data-end="}">
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#aa75ed84689ccae69938ef04eb077d8db">  234</a></span>        <span class="keyword">public</span> <span class="keywordtype">double</span>[,] <a class="code hl_function" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#aa75ed84689ccae69938ef04eb077d8db">ProductMoments</a>()</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>        {</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>            var bootMoments = <span class="keyword">new</span> <span class="keywordtype">double</span>[Replications, 4];</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>            var r = <span class="keyword">new</span> <a class="code hl_class" href="class_numerics_1_1_sampling_1_1_mersenne_twister.html">MersenneTwister</a>(PRNGSeed);</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>            var seeds = r.NextIntegers(Replications);</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>            Parallel.For(0, Replications, idx =&gt;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>            {</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>                var moments = <a class="code hl_class" href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html">Statistics</a>.<a class="code hl_function" href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html#a35bea60821d1a7d38c938fc79988c5db">ProductMoments</a>(Distribution.GenerateRandomValues(SampleSize, seeds[idx]));</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; moments.Length; i++) bootMoments[idx, i] = moments[i];</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>            });</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>            <span class="keywordflow">return</span> bootMoments;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>        }</div>
</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span> </div>
<div class="foldopen" id="foldopen00250" data-start="{" data-end="}">
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a8541cc42a683eda8101a4923e3de45ee">  250</a></span>        <span class="keyword">public</span> <span class="keywordtype">double</span>[,] <a class="code hl_function" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a8541cc42a683eda8101a4923e3de45ee">LinearMoments</a>()</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>        {</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>            var bootMoments = <span class="keyword">new</span> <span class="keywordtype">double</span>[Replications, 4];</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>            var r = <span class="keyword">new</span> <a class="code hl_class" href="class_numerics_1_1_sampling_1_1_mersenne_twister.html">MersenneTwister</a>(PRNGSeed);</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>            var seeds = r.NextIntegers(Replications);</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>            Parallel.For(0, Replications, idx =&gt;</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>            {</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>                var moments = <a class="code hl_class" href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html">Statistics</a>.<a class="code hl_function" href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html#a72e87e6acd59fccc22f7416f3010ecbb">LinearMoments</a>(Distribution.GenerateRandomValues(SampleSize, seeds[idx]));</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; moments.Length; i++) bootMoments[idx, i] = moments[i];</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>            });</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>            <span class="keywordflow">return</span> bootMoments;</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>        }</div>
</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="foldopen" id="foldopen00267" data-start="{" data-end="}">
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a049aa0a93c68e8c2aec783818048d507">  267</a></span>        <span class="keyword">public</span> <span class="keywordtype">double</span>[,] <a class="code hl_function" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a049aa0a93c68e8c2aec783818048d507">Quantiles</a>(IList&lt;double&gt; probabilities)</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>        {</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>            var Output = <span class="keyword">new</span> <span class="keywordtype">double</span>[Replications, probabilities.Count];</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>            var bootDistributions = Distributions();</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; probabilities.Count; i++)</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>                Parallel.For(0, Replications, idx =&gt; { Output[idx, i] = bootDistributions[idx] != null ? bootDistributions[idx].InverseCDF(probabilities[i]) : double.NaN; });</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>            <span class="keywordflow">return</span> Output;</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>        }</div>
</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span> </div>
<div class="foldopen" id="foldopen00280" data-start="{" data-end="}">
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a44e7999cf9c68c18ec4cb299134c61b0">  280</a></span>        <span class="keyword">public</span> <span class="keywordtype">double</span>[,] <a class="code hl_function" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a44e7999cf9c68c18ec4cb299134c61b0">Probabilities</a>(IList&lt;double&gt; quantiles)</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>        {</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>            var Output = <span class="keyword">new</span> <span class="keywordtype">double</span>[Replications, quantiles.Count];</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>            var bootDistributions = Distributions();</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; quantiles.Count; i++)</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>                Parallel.For(0, Replications, idx =&gt; { Output[idx, i] = bootDistributions[idx] != null ? bootDistributions[idx].CDF(quantiles[i]) : double.NaN; });</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>            <span class="keywordflow">return</span> Output;</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>        }</div>
</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span> </div>
<div class="foldopen" id="foldopen00296" data-start="{" data-end="}">
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ae33ebbf19cd649f2fe9467a98ded4f2c">  296</a></span>        <span class="keyword">public</span> <a class="code hl_class" href="class_numerics_1_1_distributions_1_1_uncertainty_analysis_results.html">UncertaintyAnalysisResults</a> <a class="code hl_function" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ae33ebbf19cd649f2fe9467a98ded4f2c">Estimate</a>(IList&lt;double&gt; probabilities, <span class="keywordtype">double</span> alpha = 0.1, <a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_univariate_distribution.html">IUnivariateDistribution</a>[] distributions = <span class="keyword">null</span>, <span class="keywordtype">bool</span> recordParameterSets = <span class="keyword">true</span>)</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>        {</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>            var results = <span class="keyword">new</span> <a class="code hl_class" href="class_numerics_1_1_distributions_1_1_uncertainty_analysis_results.html">UncertaintyAnalysisResults</a>();</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>            results.ParentDistribution = (<a class="code hl_class" href="class_numerics_1_1_distributions_1_1_univariate_distribution_base.html">UnivariateDistributionBase</a>)Distribution;</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span> </div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>            <span class="comment">// get mode curve</span></div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>            results.ModeCurve = <span class="keyword">new</span> <span class="keywordtype">double</span>[probabilities.Count];</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; probabilities.Count; i++)</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>                results.ModeCurve[i] = Distribution.InverseCDF(probabilities[i]);</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span> </div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>            <span class="comment">// get bootstrapped list of distributions</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>            var bootDistributions = distributions != <span class="keyword">null</span> ? distributions : Distributions();</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span> </div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>            <span class="comment">// get parameter sets</span></div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>            <span class="keywordflow">if</span> (recordParameterSets == <span class="keyword">true</span>)</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>                results.ParameterSets = ParameterSets(bootDistributions);</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span> </div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>            <span class="comment">// get confidence intervals</span></div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>            results.ConfidenceIntervals = PercentileQuantileCI(probabilities, alpha, bootDistributions);</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>     </div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>            <span class="comment">// create list of quantiles</span></div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>            var minMax = ComputeMinMaxQuantiles(0.001, 1 - 1E-9, bootDistributions);</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>            <span class="keywordtype">int</span> bins = 200;</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>            List&lt;double&gt; quantiles = <span class="keyword">new</span> List&lt;double&gt;();</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>            <span class="keywordtype">double</span> shift = 0;</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>            <span class="keywordflow">if</span> (minMax[0] &lt;= 0) shift = Math.Abs(minMax[0]) + 1d;</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>            <span class="keywordtype">double</span> min = minMax[0] + shift;</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>            <span class="keywordtype">double</span> max = minMax[1] + shift;</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>            <span class="keywordtype">int</span> order = (int)Math.Floor(Math.Log10(max) - Math.Log10(min));</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>            bins = Math.Max(200, Math.Min(1000, 100 * order));</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>            <span class="keywordtype">double</span> delta = (Math.Log10(max) - Math.Log10(min)) / (bins - 1);</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>            <span class="keywordtype">double</span> x = Math.Log10(min);</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>            quantiles.Add(Math.Pow(10, x) - shift);</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= bins - 1; i++)</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>            {</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>                x = Math.Log10(quantiles[i - 1] + shift) + delta;</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>                quantiles.Add(Math.Pow(10, x) - shift);</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>            }</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span> </div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>            <span class="comment">// get mean curve</span></div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>            results.MeanCurve = ExpectedProbabilities(quantiles, probabilities, bootDistributions);</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span> </div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>            <span class="keywordflow">return</span> results;</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>        }</div>
</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span> </div>
<div class="foldopen" id="foldopen00347" data-start="{" data-end="}">
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ada55ddbade33543d2061ed900aa4b602">  347</a></span>        <span class="keyword">public</span> <span class="keywordtype">double</span>[] <a class="code hl_function" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ada55ddbade33543d2061ed900aa4b602">ExpectedProbabilities</a>(IList&lt;double&gt; quantiles, IList&lt;double&gt; probabilities, <a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_univariate_distribution.html">IUnivariateDistribution</a>[] distributions = <span class="keyword">null</span>)</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>        {</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>            var quants = quantiles.ToArray();</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>            var probs = probabilities.ToArray();</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>            Array.Sort(quants);</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>            var expected = <span class="keyword">new</span> <span class="keywordtype">double</span>[quantiles.Count];</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>            var output = <span class="keyword">new</span> <span class="keywordtype">double</span>[probabilities.Count];</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>            var bootDistributions = distributions != <span class="keyword">null</span> ? distributions : Distributions();</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; quantiles.Count; i++)</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>            {</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>                <span class="keywordtype">double</span> total = 0d;</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>                Parallel.For(0, bootDistributions.Count(), () =&gt; 0d, (j, loop, sum) =&gt;</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>                {</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>                    if (bootDistributions[j] != null)</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>                    {</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>                        sum += bootDistributions[j].CDF(quants[i]);</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>                    }</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>                    <span class="keywordflow">return</span> sum;</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>                }, z =&gt; <a class="code hl_class" href="class_numerics_1_1_tools.html">Tools</a>.<a class="code hl_function" href="class_numerics_1_1_tools.html#a7bc8ca3251c46250fbe9ac3cd7230621">ParallelAdd</a>(ref total, z));</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>                expected[i] = total / bootDistributions.Count();</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>            }</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span> </div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>            <span class="keywordtype">double</span> minY = <span class="keywordtype">double</span>.MaxValue;</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>            <span class="keywordtype">double</span> maxY = <span class="keywordtype">double</span>.MinValue;</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>            var yVals = <span class="keyword">new</span> List&lt;double&gt;();</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>            var xVals = <span class="keyword">new</span> List&lt;double&gt;();</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>            yVals.Add(quantiles[0]);</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>            xVals.Add(expected[0]);</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; quantiles.Count; i++)</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>            {</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>                <span class="keywordflow">if</span> (expected[i] &gt; xVals.Last())</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>                {</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>                    minY = Math.Min(minY, quantiles[i]);</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>                    maxY = Math.Max(maxY, quantiles[i]);</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>                    yVals.Add(quantiles[i]);</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>                    xVals.Add(expected[i]);</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>                }</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>            }</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>            <span class="keywordtype">bool</span> useLogTransform = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>            <span class="keywordflow">if</span> (minY &gt; 0 &amp;&amp; (Math.Log10(maxY) - Math.Log10(minY)) &gt; 1)</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>                useLogTransform = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span> </div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>            <a class="code hl_class" href="class_numerics_1_1_data_1_1_linear.html">Linear</a> linint = <span class="keyword">new</span> <a class="code hl_class" href="class_numerics_1_1_data_1_1_linear.html">Linear</a>(xVals, yVals) { XTransform = <a class="code hl_enumeration" href="namespace_numerics_1_1_data.html#ae418763d3e6e0ce82ced391d67eea9d9">Transform</a>.NormalZ, YTransform = useLogTransform ?  Transform.Logarithmic : Transform.None };</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>            output = linint.<a class="code hl_function" href="class_numerics_1_1_data_1_1_interpolater.html#a690cb0aeabf6520c7450411c094d1538">Interpolate</a>(probs);</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>            <span class="keywordflow">return</span> output;</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>        }</div>
</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span> </div>
<div class="foldopen" id="foldopen00399" data-start="{" data-end="}">
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ad95d2808669699a8b849c470309f4b21">  399</a></span>        <span class="keyword">public</span> <span class="keywordtype">double</span>[] <a class="code hl_function" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ad95d2808669699a8b849c470309f4b21">ExpectedProbabilities</a>(IList&lt;double&gt; quantiles, <a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_univariate_distribution.html">IUnivariateDistribution</a>[] distributions = <span class="keyword">null</span>)</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>        {</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>            var quants = quantiles.ToArray();</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>            Array.Sort(quants);</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>            var expected = <span class="keyword">new</span> <span class="keywordtype">double</span>[quantiles.Count];</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>            var bootDistributions = distributions != <span class="keyword">null</span> ? distributions : Distributions();</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; quantiles.Count; i++)</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>            {</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>                <span class="keywordtype">double</span> total = 0d;</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>                Parallel.For(0, bootDistributions.Count(), () =&gt; 0d, (j, loop, sum) =&gt;</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>                {</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>                    if (bootDistributions[j] != null)</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>                    {</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>                        sum += bootDistributions[j].CDF(quants[i]);</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>                    }</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>                    <span class="keywordflow">return</span> sum;</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>                }, z =&gt; <a class="code hl_class" href="class_numerics_1_1_tools.html">Tools</a>.<a class="code hl_function" href="class_numerics_1_1_tools.html#a7bc8ca3251c46250fbe9ac3cd7230621">ParallelAdd</a>(ref total, z));</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>                expected[i] = total / bootDistributions.Count();</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>            }</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>            <span class="keywordflow">return</span> expected;</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>        }</div>
</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span> </div>
<div class="foldopen" id="foldopen00427" data-start="{" data-end="}">
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a61bbf6c9b28f3a4c9336b2f9a63e727b">  427</a></span>        <span class="keyword">public</span> <span class="keywordtype">double</span>[] <a class="code hl_function" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a61bbf6c9b28f3a4c9336b2f9a63e727b">ComputeMinMaxQuantiles</a>(<span class="keywordtype">double</span> minProbability, <span class="keywordtype">double</span> maxProbability, <a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_univariate_distribution.html">IUnivariateDistribution</a>[] distributions)</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>        {</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>            var output = <span class="keyword">new</span> <span class="keywordtype">double</span>[] { <span class="keywordtype">double</span>.MaxValue, double.MinValue };</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>            Parallel.For(0, distributions.Count(), j =&gt;</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>            {</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>                if (distributions[j] != null)</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>                {</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>                    var minX = distributions[j].InverseCDF(minProbability);</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>                    if (minX &lt; output[0]) output[0] = minX;</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span> </div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>                    var maxX = distributions[j].InverseCDF(maxProbability);</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>                    if (maxX &gt; output[1]) output[1] = maxX;</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>                }</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>            });</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>            <span class="keywordflow">return</span> output;</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>        }</div>
</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span> </div>
<div class="foldopen" id="foldopen00450" data-start="{" data-end="}">
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a6c6814120ae468f93abc860cc15e3296">  450</a></span>        <span class="keyword">public</span> <span class="keywordtype">double</span>[,] <a class="code hl_function" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a6c6814120ae468f93abc860cc15e3296">PercentileQuantileCI</a>(IList&lt;double&gt; probabilities, <span class="keywordtype">double</span> alpha = 0.1, <a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_univariate_distribution.html">IUnivariateDistribution</a>[] distributions = <span class="keyword">null</span>)</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>        {</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>            var CIs = <span class="keyword">new</span> <span class="keywordtype">double</span>[] { alpha / 2d, 1d - alpha / 2d };</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>            var Output = <span class="keyword">new</span> <span class="keywordtype">double</span>[probabilities.Count, 2];</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>            var bootDistributions = distributions != <span class="keyword">null</span> ? distributions : Distributions();</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; probabilities.Count; i++)</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>            {</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>                var XValues = <span class="keyword">new</span> <span class="keywordtype">double</span>[bootDistributions.Count()];</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>                Parallel.For(0, bootDistributions.Count(), idx =&gt; { XValues[idx] = bootDistributions[idx] != null ? bootDistributions[idx].InverseCDF(probabilities[i]) : double.NaN; });</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span> </div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>                <span class="comment">// sort X values</span></div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>                var validValues = XValues.Where(x =&gt; !<span class="keywordtype">double</span>.IsNaN(x)).ToArray();</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>                Array.Sort(validValues);</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span> </div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>                <span class="comment">// Record percentiles for CIs</span></div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>                    Output[i, j] = <a class="code hl_class" href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html">Statistics</a>.<a class="code hl_function" href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html#aa730682177fb23fdc263fb7f2293567d">Percentile</a>(validValues, CIs[j], <span class="keyword">true</span>);</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>            }</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>            <span class="keywordflow">return</span> Output;</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>        }</div>
</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span> </div>
<div class="foldopen" id="foldopen00477" data-start="{" data-end="}">
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a4598069c6abc29cf557a6fe45debe850">  477</a></span>        <span class="keyword">public</span> <span class="keywordtype">double</span>[,] <a class="code hl_function" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a4598069c6abc29cf557a6fe45debe850">BiasCorrectedQuantileCI</a>(IList&lt;double&gt; probabilities, <span class="keywordtype">double</span> alpha = 0.1, <a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_univariate_distribution.html">IUnivariateDistribution</a>[] distributions = <span class="keyword">null</span>)</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>        {</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>            <span class="comment">// Create list of original X values given probability values</span></div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>            var populationXValues = <span class="keyword">new</span> <span class="keywordtype">double</span>[probabilities.Count];</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; probabilities.Count; i++)</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>                populationXValues[i] = Distribution.InverseCDF(probabilities[i]);</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span> </div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>            var CIs = <span class="keyword">new</span> <span class="keywordtype">double</span>[] { alpha / 2d, 1d - alpha / 2d };</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>            var Output = <span class="keyword">new</span> <span class="keywordtype">double</span>[probabilities.Count, 2];</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>            var bootDistributions = distributions != <span class="keyword">null</span> ? distributions : Distributions();</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; probabilities.Count; i++)</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>            {</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>                <span class="keywordtype">double</span> P0 = 0d; <span class="comment">// proportions of values less than population</span></div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>                var XValues = <span class="keyword">new</span> <span class="keywordtype">double</span>[bootDistributions.Count()];</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>                Parallel.For(0, bootDistributions.Count(), () =&gt; 0d, (idx, loop, subP0) =&gt;</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>                {</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>                    XValues[idx] = bootDistributions[idx] != null ? bootDistributions[idx].InverseCDF(probabilities[i]) : double.NaN;</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>                    if (XValues[idx] != double.NaN &amp;&amp; XValues[idx] &lt;= populationXValues[i]) subP0 += 1d;</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>                    return subP0;</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>                }, z =&gt; <a class="code hl_class" href="class_numerics_1_1_tools.html">Tools</a>.<a class="code hl_function" href="class_numerics_1_1_tools.html#a7bc8ca3251c46250fbe9ac3cd7230621">ParallelAdd</a>(ref P0, z));</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span> </div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>                <span class="comment">// get proportion</span></div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>                P0 = P0 / (bootDistributions.Count() + 1);</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span> </div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>                <span class="comment">// sort X values</span></div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>                var validValues = XValues.Where(x =&gt; !<span class="keywordtype">double</span>.IsNaN(x)).ToArray();</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>                Array.Sort(validValues);</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span> </div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>                <span class="comment">// Record percentiles for CIs</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>                {</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>                    <span class="keywordtype">double</span> Z0 = <a class="code hl_class" href="class_numerics_1_1_distributions_1_1_normal.html">Normal</a>.<a class="code hl_function" href="class_numerics_1_1_distributions_1_1_normal.html#a88edb6fe71906e17e5df3d8985ac53d6">StandardZ</a>(P0);</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>                    <span class="keywordtype">double</span> Z = <a class="code hl_class" href="class_numerics_1_1_distributions_1_1_normal.html">Normal</a>.<a class="code hl_function" href="class_numerics_1_1_distributions_1_1_normal.html#a88edb6fe71906e17e5df3d8985ac53d6">StandardZ</a>(CIs[j]);</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>                    <span class="keywordtype">double</span> BC = <a class="code hl_class" href="class_numerics_1_1_distributions_1_1_normal.html">Normal</a>.<a class="code hl_function" href="class_numerics_1_1_distributions_1_1_normal.html#a1005a15158ef0d32eef47481033e6d62">StandardCDF</a>(2d * Z0 + Z);</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>                    Output[i, j] = <a class="code hl_class" href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html">Statistics</a>.<a class="code hl_function" href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html#aa730682177fb23fdc263fb7f2293567d">Percentile</a>(validValues, BC, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>                }</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>            }</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>            <span class="keywordflow">return</span> Output;</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>        }</div>
</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span> </div>
<div class="foldopen" id="foldopen00523" data-start="{" data-end="}">
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a565b8a2a427a3c917594e90a290aab0e">  523</a></span>        <span class="keyword">public</span> <span class="keywordtype">double</span>[,] <a class="code hl_function" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a565b8a2a427a3c917594e90a290aab0e">NormalQuantileCI</a>(IList&lt;double&gt; probabilities, <span class="keywordtype">double</span> alpha = 0.1, <a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_univariate_distribution.html">IUnivariateDistribution</a>[] distributions = <span class="keyword">null</span>)</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>        {</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span> </div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>            <span class="comment">// Create list of original X values given probability values</span></div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>            <span class="comment">// Use a cube-root transform to make results transformation invariant</span></div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>            var populationXValues = <span class="keyword">new</span> <span class="keywordtype">double</span>[probabilities.Count];</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; probabilities.Count; i++)</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>                populationXValues[i] = Math.Pow(Distribution.InverseCDF(probabilities[i]), 1d / 3d);</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span> </div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>            var CIs = <span class="keyword">new</span> <span class="keywordtype">double</span>[] { alpha / 2d, 1d - alpha / 2d };</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>            var Output = <span class="keyword">new</span> <span class="keywordtype">double</span>[probabilities.Count, 2];</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>            var bootDistributions = distributions != <span class="keyword">null</span> ? distributions : Distributions();</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; probabilities.Count; i++)</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>            {</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>                var XValues = <span class="keyword">new</span> <span class="keywordtype">double</span>[bootDistributions.Count()];</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>                Parallel.For(0, bootDistributions.Count(), idx =&gt; { XValues[idx] = bootDistributions[idx] != null ? Math.Pow(bootDistributions[idx].InverseCDF(probabilities[i]), 1d / 3d) : double.NaN; });</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span> </div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>                <span class="comment">// Get Standard error</span></div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>                var validValues = XValues.Where(x =&gt; !<span class="keywordtype">double</span>.IsNaN(x)).ToArray();</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>                <span class="keywordtype">double</span> SE = <a class="code hl_class" href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html">Statistics</a>.<a class="code hl_function" href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html#a30810f6f7608f937f757a5465bb15d3e">StandardDeviation</a>(validValues);</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span> </div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>                <span class="comment">// Record percentiles for CIs</span></div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>                {</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>                    <span class="keywordtype">double</span> Z = <a class="code hl_class" href="class_numerics_1_1_distributions_1_1_normal.html">Normal</a>.<a class="code hl_function" href="class_numerics_1_1_distributions_1_1_normal.html#a88edb6fe71906e17e5df3d8985ac53d6">StandardZ</a>(CIs[j]);</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>                    Output[i, j] = Math.Pow(populationXValues[i] + SE * Z, 3d);</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>                }</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>            }</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>            <span class="keywordflow">return</span> Output;</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>        }</div>
</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span> </div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span><span class="preprocessor">        #region Bias-Corrected and Accelerated</span></div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span> </div>
<div class="foldopen" id="foldopen00562" data-start="{" data-end="}">
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a468ebd55789188a4840a33600d296203">  562</a></span>        <span class="keyword">public</span> <span class="keywordtype">double</span>[,] <a class="code hl_function" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a468ebd55789188a4840a33600d296203">BCaQuantileCI</a>(IList&lt;double&gt; sampleData, IList&lt;double&gt; probabilities, <span class="keywordtype">double</span> alpha = 0.1)</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>        {</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>            var CIs = <span class="keyword">new</span> <span class="keywordtype">double</span>[] { alpha / 2d, 1d - alpha / 2d };</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>            var Output = <span class="keyword">new</span> <span class="keywordtype">double</span>[probabilities.Count, 2];</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span> </div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>            <span class="comment">// Estimate distribution</span></div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>            SampleSize = sampleData.Count;</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>            ((<a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_estimation.html">IEstimation</a>)Distribution).Estimate(sampleData, EstimationMethod);</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span> </div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>            <span class="comment">// Create list of original X values given probability values</span></div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>            var populationXValues = <span class="keyword">new</span> <span class="keywordtype">double</span>[probabilities.Count];</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; probabilities.Count; i++)</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>                populationXValues[i] = Distribution.InverseCDF(probabilities[i]);</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span> </div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>            <span class="comment">// Get acceleration constants</span></div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>            var a = AccelerationConstants(sampleData, probabilities, populationXValues);</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span> </div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>            <span class="comment">// Get bootstrapped distributions</span></div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>            var bootDistributions = Distributions();</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; probabilities.Count; i++)</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>            {</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>                <span class="keywordtype">double</span> P0 = 0d; <span class="comment">// proportions of values less than population</span></div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>                var XValues = <span class="keyword">new</span> <span class="keywordtype">double</span>[Replications];</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>                Parallel.For(0, Replications, () =&gt; 0d, (idx, loop, subP0) =&gt;</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>                {</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>                    XValues[idx] = bootDistributions[idx] != <span class="keyword">null</span> ? bootDistributions[idx].InverseCDF(probabilities[i]) : <span class="keywordtype">double</span>.NaN;</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>                    <span class="keywordflow">if</span> (XValues[idx] != <span class="keywordtype">double</span>.NaN &amp;&amp; XValues[idx] &lt;= populationXValues[i]) subP0 += 1d;</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>                    <span class="keywordflow">return</span> subP0;</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>                }, z =&gt; <a class="code hl_class" href="class_numerics_1_1_tools.html">Tools</a>.<a class="code hl_function" href="class_numerics_1_1_tools.html#a7bc8ca3251c46250fbe9ac3cd7230621">ParallelAdd</a>(ref P0, z));</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span> </div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>                <span class="comment">// get proportion</span></div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>                P0 = P0 / (Replications + 1);</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span> </div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>                <span class="comment">// sort X values</span></div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>                var validValues = XValues.Where(x =&gt; !<span class="keywordtype">double</span>.IsNaN(x)).ToArray();</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>                Array.Sort(validValues);</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span> </div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>                <span class="comment">// Record percentiles for CIs</span></div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>                {</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>                    <span class="keywordtype">double</span> Z0 = <a class="code hl_class" href="class_numerics_1_1_distributions_1_1_normal.html">Normal</a>.<a class="code hl_function" href="class_numerics_1_1_distributions_1_1_normal.html#a88edb6fe71906e17e5df3d8985ac53d6">StandardZ</a>(P0);</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>                    <span class="keywordtype">double</span> Z = <a class="code hl_class" href="class_numerics_1_1_distributions_1_1_normal.html">Normal</a>.<a class="code hl_function" href="class_numerics_1_1_distributions_1_1_normal.html#a88edb6fe71906e17e5df3d8985ac53d6">StandardZ</a>(CIs[j]);</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>                    <span class="keywordtype">double</span> num = Z0 + Z;</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>                    <span class="keywordtype">double</span> den = 1 - a[i] * (Z0 + Z);</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>                    <span class="keywordtype">double</span> BC = <a class="code hl_class" href="class_numerics_1_1_distributions_1_1_normal.html">Normal</a>.<a class="code hl_function" href="class_numerics_1_1_distributions_1_1_normal.html#a1005a15158ef0d32eef47481033e6d62">StandardCDF</a>(Z0 + num / den);</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>                    Output[i, j] = <a class="code hl_class" href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html">Statistics</a>.<a class="code hl_function" href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html#aa730682177fb23fdc263fb7f2293567d">Percentile</a>(validValues, BC, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>                }</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>            }</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>            <span class="keywordflow">return</span> Output;</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>        }</div>
</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span> </div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>        <span class="keyword">private</span> <span class="keywordtype">double</span>[] AccelerationConstants(IList&lt;double&gt; sampleData, IList&lt;double&gt; probabilities, IList&lt;double&gt; thetaHats)</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>        {</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>            var N = sampleData.Count;</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>            var I2 = <span class="keyword">new</span> <span class="keywordtype">double</span>[probabilities.Count];</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>            var I3 = <span class="keyword">new</span> <span class="keywordtype">double</span>[probabilities.Count];</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>            var a = <span class="keyword">new</span> <span class="keywordtype">double</span>[probabilities.Count];</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span> </div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>            <span class="comment">// Perform Jackknife</span></div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>            Parallel.For(0, N, idx =&gt;</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>            {</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>                <span class="comment">// Remove data point</span></div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>                var jackSample = <span class="keyword">new</span> List&lt;double&gt;(sampleData);</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>                jackSample.RemoveAt(idx);</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span> </div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>                <span class="comment">// Estimate distribution</span></div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>                var newDistribution = ((<a class="code hl_class" href="class_numerics_1_1_distributions_1_1_univariate_distribution_base.html">UnivariateDistributionBase</a>)Distribution).Clone();</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span> </div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>                <span class="keywordflow">try</span></div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>                {</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>                    ((<a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_estimation.html">IEstimation</a>)newDistribution).Estimate(jackSample, EstimationMethod);</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>                    <span class="comment">// Get quantiles from new distribution</span></div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>                    var thetaJack = <span class="keyword">new</span> <span class="keywordtype">double</span>[probabilities.Count];</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; probabilities.Count; i++)</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>                    {</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>                        thetaJack[i] = newDistribution.InverseCDF(probabilities[i]);</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>                        I2[i] += Math.Pow((N - 1) * (thetaHats[i] - thetaJack[i]), 2);</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>                        I3[i] += Math.Pow((N - 1) * (thetaHats[i] - thetaJack[i]), 3);</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>                    }</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>                }</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>                <span class="keywordflow">catch</span> (Exception)</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>                {</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>                    <span class="comment">// MLE and certain L-moments methods can fail to find a solution</span></div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>                };</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span> </div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>            });</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>            <span class="comment">// Get acceleration constant</span></div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; probabilities.Count; i++)</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>                a[i] = I3[i] / (Math.Pow(I2[i], 1.5) * 6);</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span> </div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>            <span class="keywordflow">return</span> a;</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>        }</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span> </div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span><span class="preprocessor">        #endregion</span></div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span> </div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span><span class="preprocessor">        #region Bootstrap-t (aka Student-t Bootstrap)</span></div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span> </div>
<div class="foldopen" id="foldopen00670" data-start="{" data-end="}">
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno"><a class="line" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a426cf676201e0b6845e64b88fab72123">  670</a></span>        <span class="keyword">public</span> <span class="keywordtype">double</span>[,] <a class="code hl_function" href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a426cf676201e0b6845e64b88fab72123">BootstrapTQuantileCI</a>(IList&lt;double&gt; probabilities, <span class="keywordtype">double</span> alpha = 0.1)</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>        {</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>            <span class="comment">// Create list of original X values given probability values</span></div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>            <span class="comment">// Use a cube-root transform to make results transformation invariant</span></div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>            var populationXValues = <span class="keyword">new</span> <span class="keywordtype">double</span>[probabilities.Count];</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; probabilities.Count; i++)</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>                populationXValues[i] = Math.Pow(Distribution.InverseCDF(probabilities[i]), 1d / 3d);</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span> </div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>            var xValues = <span class="keyword">new</span> <span class="keywordtype">double</span>[Replications, probabilities.Count];</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>            var studentT = <span class="keyword">new</span> <span class="keywordtype">double</span>[Replications, probabilities.Count];</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>            var CIs = <span class="keyword">new</span> <span class="keywordtype">double</span>[] { alpha / 2d, 1d - alpha / 2d };</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>            var Output = <span class="keyword">new</span> <span class="keywordtype">double</span>[probabilities.Count, 2];</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span> </div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>            <span class="comment">// First create list of bootstrap distributions, </span></div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>            <span class="comment">// and estimate standard error for each quantiles          </span></div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>            var bootDistributions = <span class="keyword">new</span> <a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_univariate_distribution.html">IUnivariateDistribution</a>[Replications];</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>            var r = <span class="keyword">new</span> <a class="code hl_class" href="class_numerics_1_1_sampling_1_1_mersenne_twister.html">MersenneTwister</a>(PRNGSeed);</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>            var seeds = r.NextIntegers(Replications);</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>            Parallel.For(0, Replications, i =&gt;</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>            {</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>                <span class="keywordflow">try</span></div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>                {</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>                    var newDistribution = ((<a class="code hl_class" href="class_numerics_1_1_distributions_1_1_univariate_distribution_base.html">UnivariateDistributionBase</a>)Distribution).Clone();</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>                    var sample = newDistribution.GenerateRandomValues(SampleSize, seeds[i]);</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>                    ((<a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_estimation.html">IEstimation</a>)newDistribution).Estimate(sample, EstimationMethod);</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>                    bootDistributions[i] = newDistribution;</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span> </div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>                    <span class="comment">// Record inner boot thetas</span></div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>                    var bootXValues = <span class="keyword">new</span> <span class="keywordtype">double</span>[probabilities.Count];</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; probabilities.Count; j++)</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>                        bootXValues[j] = Math.Pow(bootDistributions[i].InverseCDF(probabilities[j]), 1d / 3d);</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span> </div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>                    <span class="comment">// Now estimate the standard error at each quantile using the jackknife method</span></div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>                    var bootSE = StandardError(sample, probabilities, bootXValues);</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; probabilities.Count; j++)</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>                    {</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>                        xValues[i, j] = bootXValues[j];</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>                        studentT[i, j] = (populationXValues[j] - bootXValues[j]) / bootSE[j];</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>                    }</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span> </div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>                }</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>                <span class="keywordflow">catch</span> (Exception)</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>                {</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>                    <span class="comment">// MLE and certain L-moments methods can fail to find a solution</span></div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>                    <span class="comment">// On fail, set to null</span></div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>                    bootDistributions[i] = <span class="keyword">null</span>;</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; probabilities.Count; j++)</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>                    {</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>                        xValues[i, j] = <span class="keywordtype">double</span>.NaN;</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>                        studentT[i, j] = <span class="keywordtype">double</span>.NaN;</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>                    }</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>                };</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span> </div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>            });</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span> </div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span> </div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; probabilities.Count; i++)</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>            {</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>                var XValues = xValues.GetColumn(i).Where(x =&gt; !<span class="keywordtype">double</span>.IsNaN(x)).ToArray();</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>                var TValues = studentT.GetColumn(i).Where(x =&gt; !<span class="keywordtype">double</span>.IsNaN(x)).ToArray();</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span> </div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>                <span class="comment">// Get Standard error</span></div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>                <span class="keywordtype">double</span> SE = <a class="code hl_class" href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html">Statistics</a>.<a class="code hl_function" href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html#a30810f6f7608f937f757a5465bb15d3e">StandardDeviation</a>(XValues);</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>                Array.Sort(TValues);</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span> </div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>                <span class="comment">// Record percentiles for CIs</span></div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>                {</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>                    <span class="keywordtype">double</span> T = <a class="code hl_class" href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html">Statistics</a>.<a class="code hl_function" href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html#aa730682177fb23fdc263fb7f2293567d">Percentile</a>(TValues, CIs[j], <span class="keyword">true</span>);</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>                    Output[i, j] = Math.Pow(populationXValues[i] + SE * T, 3d);</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>                }</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>            }</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span> </div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>            <span class="keywordflow">return</span> Output;</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>        }</div>
</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span> </div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>        <span class="keyword">private</span> <span class="keywordtype">double</span>[] StandardError(IList&lt;double&gt; sampleData, IList&lt;double&gt; probabilities, IList&lt;double&gt; thetaHats)</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>        {</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>            var N = sampleData.Count;</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>            var I2 = <span class="keyword">new</span> <span class="keywordtype">double</span>[probabilities.Count];</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>            var se = <span class="keyword">new</span> <span class="keywordtype">double</span>[probabilities.Count];</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span> </div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>            <span class="comment">// Perform Jackknife</span></div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>            Parallel.For(0, N, idx =&gt;</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>            {</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>                <span class="comment">// Remove data point</span></div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>                var jackSample = <span class="keyword">new</span> List&lt;double&gt;(sampleData);</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>                jackSample.RemoveAt(idx);</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>                <span class="comment">// Estimate distribution</span></div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>                var newDistribution = ((<a class="code hl_class" href="class_numerics_1_1_distributions_1_1_univariate_distribution_base.html">UnivariateDistributionBase</a>)Distribution).Clone();</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span> </div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>                <span class="keywordflow">try</span></div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>                {</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>                    ((<a class="code hl_interface" href="interface_numerics_1_1_distributions_1_1_i_estimation.html">IEstimation</a>)newDistribution).Estimate(jackSample, EstimationMethod);</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>                    <span class="comment">// Get quantiles from new distribution</span></div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>                    var thetaJack = <span class="keyword">new</span> <span class="keywordtype">double</span>[probabilities.Count];</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; probabilities.Count; i++)</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>                    {</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>                        thetaJack[i] = Math.Pow(newDistribution.InverseCDF(probabilities[i]), 1d / 3d);</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>                        I2[i] += Math.Pow(thetaHats[i] - thetaJack[i], 2);</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>                    }</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>                }</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>                <span class="keywordflow">catch</span> (Exception)</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>                {</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>                    <span class="comment">// MLE and certain L-moments methods can fail to find a solution</span></div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>                    <span class="comment">// On fail, set to null</span></div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; probabilities.Count; i++)</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>                        I2[i] += 0;</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>                };</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span> </div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>            });</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>            <span class="comment">// Get standard error</span></div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; probabilities.Count; i++)</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>                se[i] = Math.Sqrt((N - 1) / (<span class="keywordtype">double</span>)N * I2[i]);</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span> </div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>            <span class="keywordflow">return</span> se;</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>        }</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span> </div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span><span class="preprocessor">        #endregion</span></div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span> </div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span><span class="preprocessor">        #endregion</span></div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span> </div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>    }</div>
</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>}</div>
<div class="ttc" id="aclass_numerics_1_1_data_1_1_interpolater_html_a690cb0aeabf6520c7450411c094d1538"><div class="ttname"><a href="class_numerics_1_1_data_1_1_interpolater.html#a690cb0aeabf6520c7450411c094d1538">Numerics.Data.Interpolater.Interpolate</a></div><div class="ttdeci">double[] Interpolate(IList&lt; double &gt; x)</div><div class="ttdoc">Given a list of x-values, returns an array of interpolated values.</div><div class="ttdef"><b>Definition</b> <a href="_interpolater_8cs_source.html#l00131">Interpolater.cs:131</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_data_1_1_linear_html"><div class="ttname"><a href="class_numerics_1_1_data_1_1_linear.html">Numerics.Data.Linear</a></div><div class="ttdoc">A class for linear interpolation.</div><div class="ttdef"><b>Definition</b> <a href="_linear_8cs_source.html#l00056">Linear.cs:57</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_data_1_1_statistics_1_1_statistics_html"><div class="ttname"><a href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html">Numerics.Data.Statistics.Statistics</a></div><div class="ttdoc">Contains functions for computing descriptive statistics of a sample of data.</div><div class="ttdef"><b>Definition</b> <a href="_statistics_8cs_source.html#l00091">Statistics.cs:92</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_data_1_1_statistics_1_1_statistics_html_a30810f6f7608f937f757a5465bb15d3e"><div class="ttname"><a href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html#a30810f6f7608f937f757a5465bb15d3e">Numerics.Data.Statistics.Statistics.StandardDeviation</a></div><div class="ttdeci">static double StandardDeviation(IList&lt; double &gt; sampleData)</div><div class="ttdoc">Estimates the unbiased population standard deviation from the provided samples as unsorted array....</div><div class="ttdef"><b>Definition</b> <a href="_statistics_8cs_source.html#l00254">Statistics.cs:254</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_data_1_1_statistics_1_1_statistics_html_a35bea60821d1a7d38c938fc79988c5db"><div class="ttname"><a href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html#a35bea60821d1a7d38c938fc79988c5db">Numerics.Data.Statistics.Statistics.ProductMoments</a></div><div class="ttdeci">static double[] ProductMoments(IList&lt; double &gt; sampleData)</div><div class="ttdoc">Returns the first four product moments of a sample {Mean, Standard Deviation, Skew,...</div><div class="ttdef"><b>Definition</b> <a href="_statistics_8cs_source.html#l00449">Statistics.cs:449</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_data_1_1_statistics_1_1_statistics_html_a72e87e6acd59fccc22f7416f3010ecbb"><div class="ttname"><a href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html#a72e87e6acd59fccc22f7416f3010ecbb">Numerics.Data.Statistics.Statistics.LinearMoments</a></div><div class="ttdeci">static double[] LinearMoments(IList&lt; double &gt; sampleData)</div><div class="ttdoc">Returns the linear moments of a sample {L-Mean (λ1), L-Scale (λ2), L-Skewness (τ3),...</div><div class="ttdef"><b>Definition</b> <a href="_statistics_8cs_source.html#l00502">Statistics.cs:502</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_data_1_1_statistics_1_1_statistics_html_aa730682177fb23fdc263fb7f2293567d"><div class="ttname"><a href="class_numerics_1_1_data_1_1_statistics_1_1_statistics.html#aa730682177fb23fdc263fb7f2293567d">Numerics.Data.Statistics.Statistics.Percentile</a></div><div class="ttdeci">static double Percentile(IList&lt; double &gt; sampleData, double k, bool sampleDataIsSorted=false)</div><div class="ttdoc">Returns the k-th percentile of values in a sample.</div><div class="ttdef"><b>Definition</b> <a href="_statistics_8cs_source.html#l00550">Statistics.cs:550</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html">Numerics.Distributions.BootstrapAnalysis</a></div><div class="ttdoc">A class for performing the bootstrap uncertainty analysis.</div><div class="ttdef"><b>Definition</b> <a href="#l00055">BootstrapAnalysis.cs:56</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_a01d522a40dc093f4bdb875850ff2574c"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a01d522a40dc093f4bdb875850ff2574c">Numerics.Distributions.BootstrapAnalysis.SampleSize</a></div><div class="ttdeci">int SampleSize</div><div class="ttdoc">Size of the bootstrap sample to generate.</div><div class="ttdef"><b>Definition</b> <a href="#l00100">BootstrapAnalysis.cs:100</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_a03b48113c802dd76e2169526c3766b87"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a03b48113c802dd76e2169526c3766b87">Numerics.Distributions.BootstrapAnalysis.Distributions</a></div><div class="ttdeci">IUnivariateDistribution[] Distributions(ParameterSet[] parameterSets)</div><div class="ttdoc">Return a list of distributions given an array of parameter sets.</div><div class="ttdef"><b>Definition</b> <a href="#l00154">BootstrapAnalysis.cs:154</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_a049aa0a93c68e8c2aec783818048d507"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a049aa0a93c68e8c2aec783818048d507">Numerics.Distributions.BootstrapAnalysis.Quantiles</a></div><div class="ttdeci">double[,] Quantiles(IList&lt; double &gt; probabilities)</div><div class="ttdoc">Bootstrap a list of quantiles given the input non-exceedance probabilities.</div><div class="ttdef"><b>Definition</b> <a href="#l00267">BootstrapAnalysis.cs:267</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_a31a94a5c9deee8820e0c271717fb6768"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a31a94a5c9deee8820e0c271717fb6768">Numerics.Distributions.BootstrapAnalysis.ParameterSets</a></div><div class="ttdeci">ParameterSet[] ParameterSets(IUnivariateDistribution[] distributions=null)</div><div class="ttdoc">Bootstrap an array of distribution parameter sets.</div><div class="ttdef"><b>Definition</b> <a href="#l00209">BootstrapAnalysis.cs:209</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_a426cf676201e0b6845e64b88fab72123"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a426cf676201e0b6845e64b88fab72123">Numerics.Distributions.BootstrapAnalysis.BootstrapTQuantileCI</a></div><div class="ttdeci">double[,] BootstrapTQuantileCI(IList&lt; double &gt; probabilities, double alpha=0.1)</div><div class="ttdoc">Bootstrap confidence intervals for a list of quantiles using the Bootstrap-t method.</div><div class="ttdef"><b>Definition</b> <a href="#l00670">BootstrapAnalysis.cs:670</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_a44e7999cf9c68c18ec4cb299134c61b0"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a44e7999cf9c68c18ec4cb299134c61b0">Numerics.Distributions.BootstrapAnalysis.Probabilities</a></div><div class="ttdeci">double[,] Probabilities(IList&lt; double &gt; quantiles)</div><div class="ttdoc">Bootstrap a list of non-exceedance probabilities given the input quantile values.</div><div class="ttdef"><b>Definition</b> <a href="#l00280">BootstrapAnalysis.cs:280</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_a4598069c6abc29cf557a6fe45debe850"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a4598069c6abc29cf557a6fe45debe850">Numerics.Distributions.BootstrapAnalysis.BiasCorrectedQuantileCI</a></div><div class="ttdeci">double[,] BiasCorrectedQuantileCI(IList&lt; double &gt; probabilities, double alpha=0.1, IUnivariateDistribution[] distributions=null)</div><div class="ttdoc">Bootstrap confidence intervals for a list of quantiles using the bias-corrected percentile method.</div><div class="ttdef"><b>Definition</b> <a href="#l00477">BootstrapAnalysis.cs:477</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_a468ebd55789188a4840a33600d296203"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a468ebd55789188a4840a33600d296203">Numerics.Distributions.BootstrapAnalysis.BCaQuantileCI</a></div><div class="ttdeci">double[,] BCaQuantileCI(IList&lt; double &gt; sampleData, IList&lt; double &gt; probabilities, double alpha=0.1)</div><div class="ttdoc">Bootstrap confidence intervals for a list of quantiles using the bias-corrected and accelerated (BCa)...</div><div class="ttdef"><b>Definition</b> <a href="#l00562">BootstrapAnalysis.cs:562</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_a4adb3913e71f970a8df129eee43813f6"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a4adb3913e71f970a8df129eee43813f6">Numerics.Distributions.BootstrapAnalysis.Distributions</a></div><div class="ttdeci">IUnivariateDistribution[] Distributions()</div><div class="ttdoc">Bootstrap a list of fitted distributions.</div><div class="ttdef"><b>Definition</b> <a href="#l00119">BootstrapAnalysis.cs:119</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_a565b8a2a427a3c917594e90a290aab0e"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a565b8a2a427a3c917594e90a290aab0e">Numerics.Distributions.BootstrapAnalysis.NormalQuantileCI</a></div><div class="ttdeci">double[,] NormalQuantileCI(IList&lt; double &gt; probabilities, double alpha=0.1, IUnivariateDistribution[] distributions=null)</div><div class="ttdoc">Bootstrap confidence intervals for a list of quantiles using the Normal, or standard method.</div><div class="ttdef"><b>Definition</b> <a href="#l00523">BootstrapAnalysis.cs:523</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_a61bbf6c9b28f3a4c9336b2f9a63e727b"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a61bbf6c9b28f3a4c9336b2f9a63e727b">Numerics.Distributions.BootstrapAnalysis.ComputeMinMaxQuantiles</a></div><div class="ttdeci">double[] ComputeMinMaxQuantiles(double minProbability, double maxProbability, IUnivariateDistribution[] distributions)</div><div class="ttdoc">Returns the min and max quantiles from a bootstrap analysis.</div><div class="ttdef"><b>Definition</b> <a href="#l00427">BootstrapAnalysis.cs:427</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_a6285e8342588812beaa78ee8c27aefe6"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a6285e8342588812beaa78ee8c27aefe6">Numerics.Distributions.BootstrapAnalysis.Parameters</a></div><div class="ttdeci">double[,] Parameters(IUnivariateDistribution[] distributions=null)</div><div class="ttdoc">Bootstrap an array of distribution parameters.</div><div class="ttdef"><b>Definition</b> <a href="#l00184">BootstrapAnalysis.cs:184</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_a65f1f143031de56c992df1fec867b66d"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a65f1f143031de56c992df1fec867b66d">Numerics.Distributions.BootstrapAnalysis.PRNGSeed</a></div><div class="ttdeci">int PRNGSeed</div><div class="ttdoc">The pseudo random number generator (PRNG) seed.</div><div class="ttdef"><b>Definition</b> <a href="#l00110">BootstrapAnalysis.cs:110</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_a6c6814120ae468f93abc860cc15e3296"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a6c6814120ae468f93abc860cc15e3296">Numerics.Distributions.BootstrapAnalysis.PercentileQuantileCI</a></div><div class="ttdeci">double[,] PercentileQuantileCI(IList&lt; double &gt; probabilities, double alpha=0.1, IUnivariateDistribution[] distributions=null)</div><div class="ttdoc">Bootstrap confidence intervals for a list of quantiles using the percentile method.</div><div class="ttdef"><b>Definition</b> <a href="#l00450">BootstrapAnalysis.cs:450</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_a8541cc42a683eda8101a4923e3de45ee"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a8541cc42a683eda8101a4923e3de45ee">Numerics.Distributions.BootstrapAnalysis.LinearMoments</a></div><div class="ttdeci">double[,] LinearMoments()</div><div class="ttdoc">Bootstrap a list of linear moments for each bootstrapped sample.</div><div class="ttdef"><b>Definition</b> <a href="#l00250">BootstrapAnalysis.cs:250</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_a88e5d424b1364cc22bb1dabe9175f5f2"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#a88e5d424b1364cc22bb1dabe9175f5f2">Numerics.Distributions.BootstrapAnalysis.Distribution</a></div><div class="ttdeci">IBootstrappable Distribution</div><div class="ttdoc">The univariate distribution to bootstrap.</div><div class="ttdef"><b>Definition</b> <a href="#l00095">BootstrapAnalysis.cs:95</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_aa75ed84689ccae69938ef04eb077d8db"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#aa75ed84689ccae69938ef04eb077d8db">Numerics.Distributions.BootstrapAnalysis.ProductMoments</a></div><div class="ttdeci">double[,] ProductMoments()</div><div class="ttdoc">Bootstrap a list of product moments for each bootstrapped sample.</div><div class="ttdef"><b>Definition</b> <a href="#l00234">BootstrapAnalysis.cs:234</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_ab424119e10d760fc36750cd9e51b5568"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ab424119e10d760fc36750cd9e51b5568">Numerics.Distributions.BootstrapAnalysis.BootstrapAnalysis</a></div><div class="ttdeci">BootstrapAnalysis(IUnivariateDistribution distribution, ParameterEstimationMethod estimationMethod, int sampleSize, int replications=10000, int seed=12345)</div><div class="ttdoc">Construct a new Bootstrap Analysis.</div><div class="ttdef"><b>Definition</b> <a href="#l00068">BootstrapAnalysis.cs:68</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_ab8c46f0743c1f95832afbda159123405"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ab8c46f0743c1f95832afbda159123405">Numerics.Distributions.BootstrapAnalysis.Replications</a></div><div class="ttdeci">int Replications</div><div class="ttdoc">The number of bootstrap replications to be sampled.</div><div class="ttdef"><b>Definition</b> <a href="#l00105">BootstrapAnalysis.cs:105</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_abdcdf72f5f676d7e424f4ef66bf91a7a"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#abdcdf72f5f676d7e424f4ef66bf91a7a">Numerics.Distributions.BootstrapAnalysis.EstimationMethod</a></div><div class="ttdeci">ParameterEstimationMethod EstimationMethod</div><div class="ttdoc">The distribution parameter estimation method.</div><div class="ttdef"><b>Definition</b> <a href="#l00090">BootstrapAnalysis.cs:90</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_ad95d2808669699a8b849c470309f4b21"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ad95d2808669699a8b849c470309f4b21">Numerics.Distributions.BootstrapAnalysis.ExpectedProbabilities</a></div><div class="ttdeci">double[] ExpectedProbabilities(IList&lt; double &gt; quantiles, IUnivariateDistribution[] distributions=null)</div><div class="ttdoc">Bootstrap the expected non-exceedance probabilities given the input quantile values.</div><div class="ttdef"><b>Definition</b> <a href="#l00399">BootstrapAnalysis.cs:399</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_ada55ddbade33543d2061ed900aa4b602"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ada55ddbade33543d2061ed900aa4b602">Numerics.Distributions.BootstrapAnalysis.ExpectedProbabilities</a></div><div class="ttdeci">double[] ExpectedProbabilities(IList&lt; double &gt; quantiles, IList&lt; double &gt; probabilities, IUnivariateDistribution[] distributions=null)</div><div class="ttdoc">Bootstrap the expected non-exceedance probabilities given the input quantile values....</div><div class="ttdef"><b>Definition</b> <a href="#l00347">BootstrapAnalysis.cs:347</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_bootstrap_analysis_html_ae33ebbf19cd649f2fe9467a98ded4f2c"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_bootstrap_analysis.html#ae33ebbf19cd649f2fe9467a98ded4f2c">Numerics.Distributions.BootstrapAnalysis.Estimate</a></div><div class="ttdeci">UncertaintyAnalysisResults Estimate(IList&lt; double &gt; probabilities, double alpha=0.1, IUnivariateDistribution[] distributions=null, bool recordParameterSets=true)</div><div class="ttdoc">Bootstrap full uncertainty analysis results using the percentile method.</div><div class="ttdef"><b>Definition</b> <a href="#l00296">BootstrapAnalysis.cs:296</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_normal_html"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_normal.html">Numerics.Distributions.Normal</a></div><div class="ttdoc">The Normal (Gaussian) probability distribution.</div><div class="ttdef"><b>Definition</b> <a href="_normal_8cs_source.html#l00065">Normal.cs:66</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_normal_html_a1005a15158ef0d32eef47481033e6d62"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_normal.html#a1005a15158ef0d32eef47481033e6d62">Numerics.Distributions.Normal.StandardCDF</a></div><div class="ttdeci">static double StandardCDF(double Z)</div><div class="ttdoc">Returns the CDF for a standard Normal distribution, where mean of 0 and standard deviation of 1.</div><div class="ttdef"><b>Definition</b> <a href="_normal_8cs_source.html#l00642">Normal.cs:642</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_normal_html_a88edb6fe71906e17e5df3d8985ac53d6"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_normal.html#a88edb6fe71906e17e5df3d8985ac53d6">Numerics.Distributions.Normal.StandardZ</a></div><div class="ttdeci">static double StandardZ(double probability)</div><div class="ttdoc">Returns the Z variate for a standard Normal distribution, where mean of 0 and standard deviation of 1...</div><div class="ttdef"><b>Definition</b> <a href="_normal_8cs_source.html#l00664">Normal.cs:664</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_uncertainty_analysis_results_html"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_uncertainty_analysis_results.html">Numerics.Distributions.UncertaintyAnalysisResults</a></div><div class="ttdoc">A class for storing distribution uncertainty analysis results.</div><div class="ttdef"><b>Definition</b> <a href="_uncertainty_analysis_results_8cs_source.html#l00053">UncertaintyAnalysisResults.cs:54</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_distributions_1_1_univariate_distribution_base_html"><div class="ttname"><a href="class_numerics_1_1_distributions_1_1_univariate_distribution_base.html">Numerics.Distributions.UnivariateDistributionBase</a></div><div class="ttdoc">Declares common functionality for all univariate distributions.</div><div class="ttdef"><b>Definition</b> <a href="_univariate_distribution_base_8cs_source.html#l00054">UnivariateDistributionBase.cs:55</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_sampling_1_1_mersenne_twister_html"><div class="ttname"><a href="class_numerics_1_1_sampling_1_1_mersenne_twister.html">Numerics.Sampling.MersenneTwister</a></div><div class="ttdoc">The Mersenne Twister pseudo-random number generator.</div><div class="ttdef"><b>Definition</b> <a href="_mersenne_twister_8cs_source.html#l00095">MersenneTwister.cs:96</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_tools_html"><div class="ttname"><a href="class_numerics_1_1_tools.html">Numerics.Tools</a></div><div class="ttdoc">A class of public utility functions.</div><div class="ttdef"><b>Definition</b> <a href="_tools_8cs_source.html#l00045">Tools.cs:46</a></div></div>
<div class="ttc" id="aclass_numerics_1_1_tools_html_a7bc8ca3251c46250fbe9ac3cd7230621"><div class="ttname"><a href="class_numerics_1_1_tools.html#a7bc8ca3251c46250fbe9ac3cd7230621">Numerics.Tools.ParallelAdd</a></div><div class="ttdeci">static double ParallelAdd(ref double valueToAddTo, double valueToAdd)</div><div class="ttdoc">Supporting function used to add doubles from an interlocked parallel loop.</div><div class="ttdef"><b>Definition</b> <a href="_tools_8cs_source.html#l00505">Tools.cs:505</a></div></div>
<div class="ttc" id="ainterface_numerics_1_1_distributions_1_1_i_bootstrappable_html"><div class="ttname"><a href="interface_numerics_1_1_distributions_1_1_i_bootstrappable.html">Numerics.Distributions.IBootstrappable</a></div><div class="ttdoc">An interface for performing the parametric bootstrap with a univariate distribution.</div><div class="ttdef"><b>Definition</b> <a href="_i_bootstrappable_8cs_source.html#l00043">IBootstrappable.cs:44</a></div></div>
<div class="ttc" id="ainterface_numerics_1_1_distributions_1_1_i_bootstrappable_html_a88c44db3a4defae4bb671e2fd71f30b1"><div class="ttname"><a href="interface_numerics_1_1_distributions_1_1_i_bootstrappable.html#a88c44db3a4defae4bb671e2fd71f30b1">Numerics.Distributions.IBootstrappable.Bootstrap</a></div><div class="ttdeci">IUnivariateDistribution Bootstrap(ParameterEstimationMethod estimationMethod, int sampleSize, int seed=-1)</div><div class="ttdoc">Bootstrap the distribution based on a sample size and parameter estimation method.</div></div>
<div class="ttc" id="ainterface_numerics_1_1_distributions_1_1_i_estimation_html"><div class="ttname"><a href="interface_numerics_1_1_distributions_1_1_i_estimation.html">Numerics.Distributions.IEstimation</a></div><div class="ttdoc">Distribution Parameter Estimation Interface.</div><div class="ttdef"><b>Definition</b> <a href="_i_estimation_8cs_source.html#l00045">IEstimation.cs:46</a></div></div>
<div class="ttc" id="ainterface_numerics_1_1_distributions_1_1_i_univariate_distribution_html"><div class="ttname"><a href="interface_numerics_1_1_distributions_1_1_i_univariate_distribution.html">Numerics.Distributions.IUnivariateDistribution</a></div><div class="ttdoc">Interface for Univariate Probability Distributions.</div><div class="ttdef"><b>Definition</b> <a href="_i_univariate_distribution_8cs_source.html#l00046">IUnivariateDistribution.cs:47</a></div></div>
<div class="ttc" id="anamespace_numerics_1_1_data_1_1_statistics_html"><div class="ttname"><a href="namespace_numerics_1_1_data_1_1_statistics.html">Numerics.Data.Statistics</a></div><div class="ttdef"><b>Definition</b> <a href="_autocorrelation_8cs_source.html#l00035">Autocorrelation.cs:36</a></div></div>
<div class="ttc" id="anamespace_numerics_1_1_data_html"><div class="ttname"><a href="namespace_numerics_1_1_data.html">Numerics.Data</a></div><div class="ttdef"><b>Definition</b> <a href="_bilinear_8cs_source.html#l00035">Bilinear.cs:36</a></div></div>
<div class="ttc" id="anamespace_numerics_1_1_data_html_ae418763d3e6e0ce82ced391d67eea9d9"><div class="ttname"><a href="namespace_numerics_1_1_data.html#ae418763d3e6e0ce82ced391d67eea9d9">Numerics.Data.Transform</a></div><div class="ttdeci">Transform</div><div class="ttdoc">Enumeration of data transformations.</div><div class="ttdef"><b>Definition</b> <a href="_transform_8cs_source.html#l00044">Transform.cs:45</a></div></div>
<div class="ttc" id="anamespace_numerics_1_1_distributions_html"><div class="ttname"><a href="namespace_numerics_1_1_distributions.html">Numerics.Distributions</a></div><div class="ttdef"><b>Definition</b> <a href="_a_m_h_copula_8cs_source.html#l00036">AMHCopula.cs:37</a></div></div>
<div class="ttc" id="anamespace_numerics_1_1_distributions_html_adc80e995453c173b9f9c8a6963b37a3b"><div class="ttname"><a href="namespace_numerics_1_1_distributions.html#adc80e995453c173b9f9c8a6963b37a3b">Numerics.Distributions.ParameterEstimationMethod</a></div><div class="ttdeci">ParameterEstimationMethod</div><div class="ttdoc">Probability Distribution Estimation Methods.</div><div class="ttdef"><b>Definition</b> <a href="_estimation_method_8cs_source.html#l00043">EstimationMethod.cs:44</a></div></div>
<div class="ttc" id="anamespace_numerics_1_1_mathematics_1_1_optimization_html"><div class="ttname"><a href="namespace_numerics_1_1_mathematics_1_1_optimization.html">Numerics.Mathematics.Optimization</a></div><div class="ttdef"><b>Definition</b> <a href="_augmented_lagrange_8cs_source.html#l00036">AugmentedLagrange.cs:37</a></div></div>
<div class="ttc" id="anamespace_numerics_1_1_sampling_html"><div class="ttname"><a href="namespace_numerics_1_1_sampling.html">Numerics.Sampling</a></div><div class="ttdef"><b>Definition</b> <a href="_latin_hypercube_8cs_source.html#l00034">LatinHypercube.cs:35</a></div></div>
<div class="ttc" id="astruct_numerics_1_1_mathematics_1_1_optimization_1_1_parameter_set_html"><div class="ttname"><a href="struct_numerics_1_1_mathematics_1_1_optimization_1_1_parameter_set.html">Numerics.Mathematics.Optimization.ParameterSet</a></div><div class="ttdoc">A class for storing an optimization trial parameter set.</div><div class="ttdef"><b>Definition</b> <a href="_parameter_set_8cs_source.html#l00046">ParameterSet.cs:47</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_22d954cd03c3057b6fcf702b65820bfa.html">Numerics</a></li><li class="navelem"><a class="el" href="dir_c88c8292768988f44d55ab09cbb0ead8.html">Distributions</a></li><li class="navelem"><a class="el" href="dir_b55e1795c99234a0c331c7ade3a7c228.html">Univariate</a></li><li class="navelem"><a class="el" href="dir_ccd071161702b1522244fe7938e6acd2.html">Uncertainty Analysis</a></li><li class="navelem"><a class="el" href="_bootstrap_analysis_8cs.html">BootstrapAnalysis.cs</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
